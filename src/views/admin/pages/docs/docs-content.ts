
export const CONCEPT = `
# ProDvor - Концепция и Видение Платформы

Этот документ описывает миссию, ключевые фичи, бизнес-логику и игровой процесс (геймплей) платформы ProDvor. Он предназначен для всех участников проекта, чтобы обеспечить единое понимание целей и механик.

## 1. Концепция и Миссия

**ProDvor** — это цифровая экосистема, которая стирает границы между реальным дворовым спортом и любительским киберспортом.

**Миссия:** Предоставить каждому игроку, независимо от уровня мастерства и дисциплины, удобную и мотивирующую платформу для самореализации, соревнований и социального взаимодействия. Мы хотим превратить каждое локальное соревнование в значимое событие, а каждую команду — в настоящую легенду.

**Наша философия:** "Твоя игра. Твои правила. Твоя арена."

## 2. Архитектура данных: Роли и Профили

Ключевой аспект архитектуры — разделение **базовой аутентификации** от **ролевых данных**.

- **User (Пользователь):** Центральная сущность, отвечающая за вход, основные данные (имя, аватар) и социальные связи. У одного пользователя может быть несколько ролей.
- **Профили (\`PlayerProfile\`, \`RefereeProfile\` и т.д.):** Отдельные сущности, связанные с \`User\` через \`userId\`. Они хранят уникальные данные, специфичные для каждой роли.

Такой подход обеспечивает:
- **Гибкость:** Пользователь может иметь несколько ролей одновременно (например, быть "Игроком" и "Тренером"), и для каждой роли у него будет свой набор данных.
- **Масштабируемость:** Легко добавлять новые роли в будущем, не изменяя базовую таблицу \`User\`.
- **Чистота данных:** В основной сущности \`User\` нет полей, которые были бы \`NULL\` для большинства пользователей (например, поле "судейская категория" не нужно игроку).

## 3. Целевая Аудитория

1.  **Активные игроки:** Любители, играющие в футбол, баскетбол, волейбол на уличных площадках.
2.  **Капитаны и организаторы:** Энтузиасты, которые собирают команды и организуют локальные турниры.
3.  **Болельщики:** Друзья, родственники и просто зрители, которые следят за успехами команд.
4.  **Профессионалы:** Судьи, тренеры, менеджеры, которые ищут площадку для развития и применения своих навыков.

## 4. Ключевые Фичи

### 4.1. Единый Профиль (ProDvor ID)

- **Мульти-дисциплинарность:** Один профиль для всех видов спорта.
- **Статистика и достижения:** Подробная статистика по матчам, турнирам, индивидуальным показателям. Система ачивок.
- **Роли:** Пользователь может быть не только игроком, но и капитаном, тренером, судьей, организатором.

### 4.2. Команды

- **Создание и управление:** Полный функционал для капитана (приглашение игроков, управление составом, подача заявок на турниры).
- **Командный профиль:** Уникальная страница команды с логотипом (генерируемым AI), статистикой, историей матчей и составом.
- **Командный чат:** Внутренний мессенджер для координации.

### 4.3. Соревнования

- **Лиги и Турниры:** Регулярные соревнования с разными форматами (плей-офф, круговая система).
- **Вызовы (Challenges):** Возможность бросить вызов другой команде в любое время.
- **Автоматизированные сетки:** Удобные и наглядные турнирные таблицы, которые обновляются в реальном времени.

### 4.4. AI-Помощники

- **AI-Генератор логотипов:** Инструмент для создания уникальной айдентики команды на основе текстового описания.
- **AI-Аналитик матчей:** (В перспективе) Возможность загрузки видео матча для получения анализа ключевых моментов.
- **AI-Дайджест:** Автоматическая генерация новостей и сводок о прошедших и предстоящих играх.

### 4.5. Социальная Платформа

- **Лента новостей:** Посты от игроков и команд, анонсы матчей, результаты.
- **Поиск:** Умный поиск игроков, команд и турниров по различным критериям (город, вид спорта, уровень игры).
- **Система рейтинга:** Глобальный и локальный рейтинг для игроков и команд (ELO-подобная система).

### 4.6. Центр Судей (Referee Hub)

Это профессиональный инструмент для судей, который превращает их участие на платформе в полноценную карьеру. Доступен только пользователям с ролью "Судья".

**Миссия Центра:** Создать прозрачную и мотивирующую среду для роста и развития спортивных арбитров.

**Ключевые модули:**

1.  **Образовательная Платформа:**
    *   **Курсы повышения квалификации:** Видео-лекции, текстовые материалы и симуляторы спорных моментов (интерактивные тесты на основе видео).
    *   **Треки развития:** Персональные рекомендации по обучению в зависимости от выбранной дисциплины и текущей категории судьи.
    *   **Сертификация:** По окончании курсов выдаются цифровые сертификаты, которые отображаются в профиле.

2.  **База Знаний:**
    *   **Единый регламент:** Всегда актуальные версии правил по всем видам спорта, представленным на платформе.
    *   **Разбор кейсов:** Официальные трактовки сложных и спорных игровых ситуаций от экспертов ProDvor.
    *   **Быстрый поиск:** Удобная навигация и поиск по ключевым словам для оперативного нахождения нужного правила во время матча.

3.  **Аттестация и Рейтинг:**
    *   **Регулярное тестирование:** Онлайн-тесты для подтверждения и повышения судейской категории (например, с "Второй" до "Первой").
    *   **Публичный рейтинг судей:** Рейтинг, основанный на категории, количестве проведенных матчей и оценках от организаторов и капитанов команд.
    *   **Доступ к матчам:** Высокий рейтинг и категория открывают доступ к судейству более престижных турниров с большим призовым фондом.

## 5. Бизнес-логика и Монетизация

Платформа будет бесплатной для основного функционала, чтобы привлечь максимальное количество пользователей. Монетизация планируется через:

1.  **Pro-аккаунты (Подписка):**
    - Расширенная статистика.
    - Дополнительные попытки генерации логотипов.
    - Кастомизация профиля и командной страницы.
    - Доступ к премиальным AI-инструментам (анализ видео).
    - **Доступ к продвинутым курсам в Центре Судей.**

2.  **Организаторские инструменты:**
    - Платные пакеты для организаторов турниров (брендирование, увеличенное количество участников, призовые фонды от платформы).

3.  **Встроенный магазин (Marketplace):**
    - Продажа виртуальных предметов (уникальные рамки, значки, кастомные лого).
    - Партнерство с брендами спортивной атрибутики и инвентаря.

4.  **Спонсорство:**
    - Привлечение спонсоров для крупных лиг и турниров.

## 6. Логика приватности

Система приватности позволяет пользователям тонко настраивать видимость своего профиля и контента. Вся логика проверки прав доступа должна выполняться на бэкенде **перед** отправкой данных клиенту.

**Уровни доступа:**
- **Все пользователи (\`all\`):** Доступно всем аутентифицированным пользователям платформы.
- **Только друзья (\`friends\`):** Доступно только пользователям из списка \`friends\` текущего пользователя.
- **Только я (\`nobody\`):** Доступно только владельцу профиля.

| Настройка | Поле в БД (\`User.privacySettings\`) | Описание логики |
| :--- | :--- | :--- |
| **Профиль** | | |
| Кто видит основную информацию | \`profile_visibility\` | **Бэкенд:** При запросе \`/users/:id\`, если запрашивающий не является владельцем, проверяется это поле. Если доступ ограничен, возвращаются только публичные данные (никнейм, аватар). |
| Кто видит команды и дисциплины | \`teams_visibility\` | **Бэкенд:** При запросе профиля, список команд и дисциплин отдается только если запрашивающий соответствует настройке. |
| Кто видит друзей и подписки | \`socials_visibility\` | **Бэкенд:** Список друзей и подписок (\`friends\`, \`followingUsers\`) отдается только если запрашивающий соответствует настройке. |
| **Публикации** | | |
| Кто видит мои медиа | \`media_visibility\` | **Бэкенд:** Эндпоинт, возвращающий медиа пользователя, должен проверять эту настройку. |
| Кто может отмечать меня | \`tagging_permissions\` | **Бэкенд:** При попытке отметить пользователя, сервис должен проверить, есть ли у отмечающего права на это действие. |
| **Связь со мной** | | |
| Кто может писать сообщения | \`messages_privacy\` | **Бэкенд:** Сервис сообщений должен проверять эту настройку перед тем, как позволить начать новый диалог. |
| Кто может приглашать в команды | \`invites_privacy\` | **Бэкенд:** При отправке приглашения в команду, проверяется, соответствует ли капитан-отправитель этой настройке. |
| **Прочее** | | |
| Видимость для гостей | \`public_profile\` | **Бэкенд:** Определяет, доступен ли профиль по прямой ссылке для неаутентифицированных пользователей. |
| Закрытый профиль | \`is_profile_private\` | **Бэкенд:** Если \`true\`, эта настройка переопределяет все остальные и делает профиль видимым только для друзей. |

## 7. Игровой Процесс (Gameplay Loop)

1.  **Регистрация:** Пользователь создает свой ProDvor ID.
2.  **Онбординг:** Пользователь указывает свои любимые дисциплины, уровень игры и цели на платформе.
3.  **Присоединение/Создание команды:** Пользователь находит команду или создает свою, приглашая друзей.
4.  **Первый матч:** Команда бросает вызов другой команде или регистрируется на свой первый турнир.
5.  **Прогресс:** За участие и победы команда и игроки получают очки рейтинга, открывают достижения. Судьи повышают свою квалификацию в **Центре Судей**.
6.  **Социализация:** Игроки делятся успехами в ленте, общаются, следят за другими командами.
7.  **Рост:** Команда поднимается в рейтинге, участвует в более престижных лигах и борется за реальные призы.
8.  **Цикл повторяется:** Новые сезоны, новые турниры, новые вызовы поддерживают постоянный интерес.

## 8. Система прогрессии

### 8.1. Графики статистики игрока

В профиле игрока отображаются два ключевых графика для визуализации его прогресса: радар навыков и динамика ELO.

-   **Радар навыков ("паутинка"):** Этот график наглядно показывает сильные и слабые стороны игрока по ключевым атрибутам (например, Атака, Защита, Техника, Скорость, Пас).
    -   **Логика:** Эти значения **не вводятся пользователем вручную**. Они должны **рассчитываться на бэкенде** на основе агрегированных данных из протоколов матчей за определенный период (например, последние 10-20 игр).
    -   **Пример расчета:**
        -   **Атака:** Учитывает голы, удары в створ, успешные обводки в атаке.
        -   **Защита:** Учитывает отборы, перехваты, блокировки.
        -   **Пас:** Учитывает голевые передачи, точность пасов.
    -   Все показатели должны быть нормализованы (приведены к шкале 0-100) для корректного отображения на радаре.

-   **График прогресса ELO:** Это линейный график, который показывает **историю изменения персонального ELO-рейтинга** игрока.
    -   **Логика:** Бэкенд должен хранить историю изменений ELO для каждого игрока. При запросе профиля, эндпоинт должен возвращать данные за последние 6-12 месяцев для построения графика. Этот график является ключевым показателем роста и стабильности игрока в соревновательной системе.

### 8.2. Очки Прогресса (ОП)

Очки Прогресса (ОП, англ. Progress Points, PP) — это основа системы геймификации, не связанная с ELO-рейтингом. ОП начисляются за любую полезную активность на платформе, мотивируя пользователей взаимодействовать с различными ее частями.

-   **Назначение:** Открытие достижений, повышение уровня аккаунта, разблокировка косметических наград.
-   **Логика:** Бэкенд должен иметь сервис, который принимает события от других сервисов (например, "матч завершен", "пост создан") и начисляет соответствующее количество очков.

**Таблица начисления Очков Прогресса:**

| Событие                         | Код события                  | Очки | Описание                                        |
| ------------------------------- | ---------------------------- | ---- | ----------------------------------------------- |
| **Соревнования**                |                              |      |                                                 |
| Участие в матче                 | \`match_participation\`      | 50   | Начисляется каждому участнику после матча.       |
| Победа в матче                  | \`match_win\`                | 100  | Бонус к участию за победу.                      |
| Участие в турнире               | \`tournament_participation\` | 250  | Начисляется после первого сыгранного матча.      |
| Победа в турнире                | \`tournament_win\`           | 1000 | Начисляется команде-победителю.                  |
| **Тренировки**                  |                              |      |                                                 |
| Тренировка завершена            | \`training_completed\`       | 75   | За завершение тренировки по плану.              |
| План тренировок создан          | \`fitness_plan_created\`     | 150  | За создание и сохранение нового плана.          |
| **Социальная активность**       |                              |      |                                                 |
| Пост создан                     | \`post_created\`             | 10   |                                                 |
| Комментарий создан              | \`comment_created\`          | 5    |                                                 |
| Подписка на пользователя        | \`profile_followed\`         | 1    |                                                 |
| Подписка на команду             | \`team_followed\`            | 5    |                                                 |
| **Достижения**                  |                              |      |                                                 |
| Достижение открыто              | \`achievement_unlocked\`     | 200  |                                                 |
| **Вклад в платформу**           |                              |      |                                                 |
| Новая площадка добавлена        | \`playground_added\`         | 300  | Начисляется после успешной модерации.           |
| Команда создана                 | \`team_created\`             | 100  |                                                 |

## 9. Система рейтинга ELO

Система рейтинга Эло — это метод для расчёта относительной силы игроков/команд.

-   **Назначение:** Обеспечение справедливого матчмейкинга, формирование лиг и таблиц лидеров, отслеживание соревновательного роста.
-   **Логика:** После каждого официального матча (турнирного или рейтингового вызова) бэкенд должен пересчитывать ELO-рейтинги обеих команд.

**Ключевые принципы:**

-   **Разница в рейтингах** позволяет предсказать ожидаемый результат матча.
-   **Рейтинг обновляется** после каждого матча на основе фактического и ожидаемого результатов.
-   За победу над **более сильным** соперником дается **больше** очков, чем за победу над **более слабым**.
-   **K-фактор:** Определяет, насколько сильно результат одного матча влияет на изменение рейтинга. Для нашей платформы используется \`K_FACTOR = 32\`, что является стандартным значением для новых и активно играющих систем.

**Формула расчета:**

1.  **Ожидаемый результат (вероятность победы) для Команды А:**
    \`\`\`
    ExpectedScore(A) = 1 / (1 + 10^((Rating(B) - Rating(A)) / 400))
    \`\`\`
2.  **Обновление рейтинга для Команды А:**
    \`\`\`
    NewRating(A) = Rating(A) + K_FACTOR * (ActualScore(A) - ExpectedScore(A))
    \`\`\`
    Где \`ActualScore\` = 1 для победы, 0.5 для ничьей, 0 для поражения.

Эта логика должна быть инкапсулирована в отдельном сервисе, который вызывается после подтверждения результатов матча.

## 10. Архитектура будущих микросервисов

Для обеспечения масштабируемости, гибкости и независимой разработки ключевые модули платформы ProDvor спроектированы с возможностью их выделения в отдельные микросервисы.

### 10.1. Admin Core & Auth Service

-   **Назначение:** Сердце административной панели и системы безопасности. Отвечает за управление администраторами, их ролями и доступом.
-   **Зона ответственности:**
    -   Реализация отдельной, изолированной системы аутентификации для админ-панели.
    -   **Управление ролями администраторов:** Создание и назначение ролей (Главный админ, Менеджер турниров, Модератор контента и т.д.).
    -   **Динамическая генерация паролей:** Создание временных паролей для каждой роли, которые дают доступ только к определенным разделам (микросервисам).
    -   **Логика сброса паролей:** Реализация запланированной задачи (cron job) для ежедневного сброса паролей и принудительного разлогинивания.
    -   Предоставление UI для "Главного администратора" для управления другими админами и отправки им новых паролей.

### 10.2. Tournament CRM Service

-   **Назначение:** Комплексный сервис для управления жизненным циклом соревнований.
-   **Зона ответственности:**
    -   Создание и настройка турниров (формат, правила, расписание).
    -   Управление регистрацией участников и подтверждение заявок.
    -   Генерация и обновление турнирных сеток (brackets).
    -   Ведение протоколов матчей в реальном времени.
    -   Управление персоналом турнира (судьи, организаторы).
    -   Интеграция с сервисом финансов для учета взносов.

### 10.3. Gamification & Ranking Service

-   **Назначение:** Сервис, отвечающий за все игровые и соревновательные механики, повышающие вовлеченность пользователей.
-   **Зона ответственности:**
    -   Расчет и обновление рейтинга ELO для игроков и команд после каждого матча.
    -   Управление системой рангов и их присвоение.
    -   Трекинг и выдача достижений (ачивок).
    -   Начисление "Очков Прогресса" за различные действия на платформе (участие в матче, создание поста и т.д.), как описано в \`/src/shared/lib/gamification.ts\`.

### 10.4. Ad-CRM Service (Сервис Монетизации)

-   **Назначение:** Сервис для управления монетизацией платформы через рекламный инвентарь.
-   **Зона ответственности:**
    1.  **Управление рекламным инвентарем:**
        *   Создание и управление рекламными слотами (баннер в ленте, брендирование турнира и т.д.).
        *   Интерактивная "Карта инвентаря", показывающая доступность и статистику по каждому слоту.
    2.  **Менеджер Кампаний:**
        *   Создание, запуск, приостановка и архивация рекламных кампаний.
        *   Загрузка креативов (баннеров).
        *   Привязка кампаний к определенным аудиторным сегментам.
    3.  **Менеджер Аудиторий:**
        *   Создание пользовательских сегментов на основе множества критериев (дисциплина, роль, ELO-рейтинг, география, возраст).
        *   Расчет потенциального охвата и прогнозируемого дохода для каждого сегмента.
    4.  **Аналитика и Прогнозирование:**
        *   Сбор статистики по показам, кликам и доходу (CTR, eCPM, Fill-rate).
        *   **Интерактивный симулятор дохода:** Бэкенд должен предоставлять эндпоинт, который принимает на вход базовые параметры (MAU, eCPM, Fill-rate) и "рычаги роста" (активированные стратегии), а на выходе отдает полный финансовый прогноз: годовой доход, его распределение, анализ чувствительности и квартальный план.
        *   Расчет окупаемости на основе прогнозируемого EBITDA.
`;

export const README = `
# Техническая документация ProDvor

Этот документ предназначен для разработчиков и содержит описание ключевых технических аспектов, архитектуры и используемого стека платформы.

---

## 1. Стек технологий

- **Фронтенд:** Next.js, React, TypeScript
- **UI-компоненты:** ShadCN/UI
- **Стилизация:** Tailwind CSS
- **Состояние (State Management):** Zustand
- **Формы:** React Hook Form с Zod для валидации
- **Карты:** Yandex Maps API v3
- **Генеративный AI:** Genkit (Google AI)
- **Аутентификация:** Firebase Authentication (в перспективе)
- **База данных:** Firestore (в перспективе)
- **Линтинг и форматирование:** ESLint, Prettier

---

## 2. Структура проекта (Feature-Sliced Design)

Проект использует App Router из Next.js и стремится к архитектуре Feature-Sliced Design (FSD) для лучшей организации и масштабируемости.

- **\`src/app/\`**: **Слой Pages.** Содержит все маршруты, страницы и лейауты приложения.
  - **\`(main)/\`**: Группа маршрутов для аутентифицированных пользователей.
  - **\`(public)/\`**: Группа маршрутов для публичных страниц.
  - **\`admin/\`**: Панель администратора.
  - **\`api/\`**: API-роуты Next.js.

- **\`src/views/\`**: **Слой Pages.** Компоненты-страницы, которые собирают виджеты и фичи для конкретного маршрута.

- **\`src/features/\`**: **Слой Features.** Содержит компоненты с бизнес-логикой и пользовательскими сценариями (например, \`features/ai-analysis-tool\`, \`features/logo-generator\`, \`features/protocol-editor\`).

- **\`src/widgets/\`**: **Слой Widgets.** Крупные, переиспользуемые композиционные блоки UI, состоящие из нескольких компонентов, фич и сущностей (например, \`widgets/dashboard-header\`, \`widgets/top-teams-widget\`).

- **\`src/entities/\`**: **Слой Entities.** "Атомарные" компоненты, представляющие бизнес-сущности и их UI-представления (например, \`entities/team/ui/TeamCard.tsx\`, \`entities/user/\`).

- **\`src/shared/\`**: **Слой Shared.** Общий код, используемый во всем приложении, без привязки к бизнес-логике.
  - **\`ui/\`**: Базовые UI-компоненты (Button, Card, Input).
  - **\`lib/\`**: Общие утилиты и хелперы.
  - **\`hooks/\`**: Глобальные хуки.
  - **\`api/\`**: Функции для взаимодействия с бэкендом.

- **\`src/mocks/\`**: Моковые (тестовые) данные для симуляции работы приложения.

- **\`src/ai/\`**: Файлы, связанные с Genkit, для работы с генеративным AI.

---

## 3. Работа с данными

На текущем этапе прототипирования все данные являются моковыми и хранятся в директории \`src/mocks\`.

- **Симуляция пользователя:** Глобальное состояние текущего пользователя управляется через Zustand-стор \`useUserStore\` (\`src/widgets/dashboard-header/model/user-store.ts\`). Это позволяет "входить" под видом разных пользователей через панель администратора (\`/admin/simulation\`) и видеть платформу их глазами.

- **Server Actions:** Все "бэкенд" вызовы инкапсулированы в Server Actions в файле \`src/app/actions.ts\`. Эти функции вызываются с клиентских компонентов и выполняются на сервере. На данный момент они работают с моковыми данными, но в будущем будут заменены на реальные API-вызовы к микросервисам.

---

## 4. UI и Компоненты

- **ShadCN/UI:** Мы используем библиотеку компонентов ShadCN/UI как основу. Компоненты не импортируются напрямую, а копируются в проект (\`src/shared/ui\`), что дает полный контроль над их кодом и стилями.

- **\`cn\` утилита:** Для условного и приоритетного применения CSS-классов используется утилита \`cn\`, которая объединяет \`clsx\` и \`tailwind-merge\`.

- **Иконостас:** Используется библиотека \`lucide-react\` для иконок.

- **Адаптивность:** Основные лейауты и компоненты адаптированы для мобильных устройств. Для переключения между десктопным и мобильным видом используется хук \`useIsMobile\`.

---

## 5. Генеративный AI (Genkit)

Для реализации AI-функций используется фреймворк Genkit.

- **Инициализация:** Глобальный объект \`ai\` создается в \`src/ai/genkit.ts\`.
- **Флоу (Flows):** Вся AI-логика инкапсулирована во "флоу" — асинхронных функциях, определенных через \`ai.defineFlow\`. Каждый флоу имеет типизированные входные и выходные данные с использованием Zod-схем.
- **Промпты (Prompts):** Внутри флоу используются \`ai.definePrompt\`, которые содержат шаблон промпта для языковой модели. Это позволяет отделить саму инструкцию для AI от бизнес-логики флоу.
- **Примеры:**
  - \`src/shared/api/generate-team-logo-variations.ts\`: Генерация логотипов (text-to-image).
  - \`src/shared/api/analyze-match-video.ts\`: Анализ видео (заглушка).
  - \`src/shared/api/generate-news-digest.ts\`: Генерация текста (text-to-text).

---

## 6. Как запустить проект

1.  Убедитесь, что у вас установлены Node.js и npm.
2.  Установите зависимости: \`npm install\`
3.  Создайте файл \`.env\` в корне проекта и добавьте в него ваш API-ключ для Google AI:
    \`\`\`
    GEMINI_API_KEY=ВАШ_КЛЮЧ
    \`\`\`
4.  Запустите сервер для разработки: \`npm run dev\`
5.  Откройте [http://localhost:9002](http://localhost:9002) в вашем браузере.

---
`;
