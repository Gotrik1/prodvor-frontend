
# План миграции бэкенда на Python (Flask) для проекта ProDvor

Этот документ содержит полный план и серию промптов для создания Python-бэкенда, который будет полностью совместим с существующим фронтендом ProDvor.

**Стратегия:** Мы будем использовать фреймворк Flask с SQLAlchemy для работы с базой данных. Каждый промпт ниже представляет собой законченный шаг, который можно последовательно отправлять AI-ассистенту в новом проекте Firebase Studio, созданном на основе шаблона "Python (Flask)".

---

## Шаг 1: Настройка проекта и создание моделей данных

**Промпт 1:**

"Привет! Давай создадим основу нашего Flask-приложения. Нам нужно:
1.  Инициализировать Flask-приложение.
2.  Настроить SQLAlchemy для работы с базой данных SQLite.
3.  Создать модели данных (SQLAlchemy models) для следующих сущностей: `User`, `Team`, `PlayerProfile`, `Tournament`.

Вот структура моделей:

-   **User**:
    -   `id`: `Integer`, первичный ключ
    -   `nickname`: `String(80)`, уникальный, не может быть null
    -   `email`: `String(120)`, уникальный, не может быть null
    -   `avatarUrl`: `String(200)`
    -   `role`: `String(50)`, не может быть null

-   **Team**:
    -   `id`: `Integer`, первичный ключ
    -   `name`: `String(120)`, не может быть null
    -   `logoUrl`: `String(200)`
    -   `captainId`: `Integer`, внешний ключ к `user.id`
    -   `game`: `String(100)`
    -   `rank`: `Integer`, по умолчанию `1200`

-   **PlayerProfile**:
    -   `id`: `Integer`, первичный ключ
    -   `userId`: `Integer`, внешний ключ к `user.id`, уникальный
    -   `elo`: `Integer`, по умолчанию `1000`
    -   `matchesPlayed`: `Integer`, по умолчанию `0`
    -   `wins`: `Integer`, по умолчанию `0`

-   **Tournament**:
    -   `id`: `Integer`, первичный ключ
    -   `name`: `String(150)`, не может быть null
    -   `game`: `String(100)`
    -   `status`: `String(50)`
    -   `prizePool`: `String(100)`
    -   `participants`: `Integer`
    -   `maxParticipants`: `Integer`
    -   `startDate`: `String(100)`

Пожалуйста, создай файл `app.py` со всем этим кодом и инициализируй базу данных."

---

## Шаг 2: Создание API для Пользователей (Users)

**Промпт 2:**

"Отлично! Теперь давай создадим API для работы с пользователями в файле `app.py`. Нам нужны следующие эндпоинты:

1.  **`GET /api/v1/users`**:
    -   Должен возвращать список всех пользователей из базы данных.
    -   Каждый объект в списке должен содержать `id`, `nickname`, `email`, `avatarUrl`, `role`.

2.  **`GET /api/v1/users/<int:user_id>`**:
    -   Должен находить пользователя по `user_id` и возвращать его данные (`id`, `nickname`, `email`, `avatarUrl`, `role`).
    -   Если пользователь не найден, возвращать ошибку 404.

3.  **`POST /api/v1/users`**:
    -   Должен создавать нового пользователя.
    -   Принимает JSON с полями: `nickname`, `email`, `role`.
    -   Должен проверять, что `nickname` и `email` уникальны. Если нет, возвращать ошибку 400.
    -   Возвращает созданный объект пользователя со статусом 201."

---

## Шаг 3: Создание API для Команд (Teams)

**Промпт 3:**

"Продолжаем. Теперь нам нужен API для команд в `app.py`. Реализуй следующие эндпоинты:

1.  **`GET /api/v1/teams`**:
    -   Должен возвращать список всех команд.
    -   Каждая команда в списке должна содержать все поля из модели `Team`.

2.  **`GET /api/v1/teams/<int:team_id>`**:
    -   Должен находить команду по `team_id` и возвращать её полные данные.
    -   Если команда не найдена, возвращать ошибку 404.

3.  **`POST /api/v1/teams`**:
    -   Должен создавать новую команду.
    -   Принимает JSON с полями: `name`, `captainId`, `game`.
    -   `logoUrl` и `rank` должны иметь значения по умолчанию.
    -   Возвращает созданный объект команды со статусом 201."

---

## Шаг 4: Создание API для Турниров (Tournaments)

**Промпт 4:**

"Почти готово. Осталось реализовать API для турниров в том же файле `app.py`.

1.  **`GET /api/v1/tournaments`**:
    -   Должен возвращать список всех турниров со всеми полями.

2.  **`GET /api/v1/tournaments/<int:tournament_id>`**:
    -   Должен находить турнир по `tournament_id` и возвращать его полные данные.
    -   Если турнир не найден, возвращать ошибку 404.

3.  **`POST /api/v1/tournaments`**:
    -   Должен создавать новый турнир.
    -   Принимает JSON с полями: `name`, `game`, `status`, `maxParticipants`, `startDate`.
    -   Возвращает созданный объект турнира со статусом 201."

---

После выполнения этих четырех шагов у вас будет готов базовый Python-бэкенд, полностью соответствующий потребностям текущего фронтенда. Вы сможете заменить моковые данные в файлах фронтенда на реальные вызовы к этим API.
