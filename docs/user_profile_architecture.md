# Архитектура страницы профиля пользователя

Этот документ описывает комплексный подход к построению страницы профиля, обеспечивающий гибкость, производительность и масштабируемость.

## 1. Принцип: Агрегация данных на бэкенде

**Проблема:** Страница профиля — это сложный конгломерат данных: личная информация, статистика, списки друзей, команды, посты. Загрузка каждого элемента отдельным запросом с фронтенда ("эффект водопада") приведет к медленной и "дерганой" отрисовке.

**Решение:** Бэкенд должен предоставлять **один основной эндпоинт** (`GET /api/v1/users/:id`), который агрегирует и возвращает всю необходимую информацию для **первого экрана** профиля. "Тяжелые" и бесконечные списки (посты, полные списки друзей) должны подгружаться отдельно по мере необходимости.

## 2. Структура ответа API для профиля

Основной эндпоинт `GET /api/v1/users/:id` должен возвращать объект, структурированный для удобного рендеринга на фронтенде.

```json
{
  "id": "user-1",
  "firstName": "Иван",
  "lastName": "Иванов",
  "nickname": "IvanTheGreat",
  "avatarUrl": "https://...",
  "coverImageUrl": "https://...",
  "role": "Игрок",
  "city": "Москва",
  "bio": "Люблю футбол и свою команду!",
  "elo": 1550,

  // --- Игровая статистика из 'player_profiles' ---
  "player_profile": {
    "matchesPlayed": 120,
    "wins": 79,
    "goals": 0,
    "assists": 0,
    "mvpAwards": 0
  },

  // --- Команды пользователя (если запрошено с ?include_teams=true) ---
  "teams": [
    { "id": "team-1", "name": "Ночные Снайперы", "logoUrl": "..." }
  ],

  // --- Динамические кнопки действий ---
  "profile_buttons": [
    { "action": { "type": "friend_request", "status": "already_friend" }, "text": "Вы друзья" },
    { "action": { "type": "write_message" }, "text": "Сообщение" }
  ],
  
  // --- Счетчики для виджетов ---
  "counters": {
    "friends": 54,
    "followers": 128,
    "posts": 42
  }
}
```

## 3. Отдельные эндпоинты для списков

Для данных, которые не нужны для первого рендера, используются отдельные эндпоинты с пагинацией.

-   **`GET /api/v1/users/:id/friends`**: Получить список друзей.
-   **`GET /api/v1/users/:id/followers`**: Получить список подписчиков.
-   **`GET /api/v1/users/:id/following`**: Получить список подписок.
-   **`GET /api/v1/users/:id/posts`**: Получить посты со стены пользователя.

Такой подход обеспечивает быструю начальную загрузку профиля и позволяет догружать данные по мере взаимодействия пользователя с интерфейсом.
