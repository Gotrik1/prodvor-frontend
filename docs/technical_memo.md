# Техническая памятка по интеграции с бэкендом (ProDvor)

**ВАЖНО:** Этот документ содержит подтвержденные и работающие решения по интеграции с бэкендом. Не изменять описанную здесь логику без крайней необходимости.

---

## 1. Сетевое соединение и CORS

- **Статус:** **Решено и стабильно.**
- **URL бэкенда:** Адрес хранится в переменной `NEXT_PUBLIC_API_BASE_URL` в файле `.env` и использует протокол `https://`.
- **CORS:** Настроен на стороне бэкенда (`access-control-allow-origin: *`). Проблем с CORS нет.
- **Действие:** **Не изменять** сетевые настройки, URL бэкенда или `next.config.ts` в попытках "исправить" сетевые ошибки. Проблема, скорее всего, в другом.

---

## 2. Логика авторизации

- **Статус:** **Решено.**
- **Эндпоинт:** `POST /api/v1/login`
- **Логика:** Бэкенд возвращает **единый JSON-объект**, содержащий `accessToken`, `refreshToken` и полный объект `user`.
    ```json
    {
      "accessToken": "ey...",
      "refreshToken": "ey...",
      "user": { ... }
    }
    ```
- **Действие:** Фронтенд **не делает** дополнительный запрос на `/api/v1/users/me` после логина. Данные пользователя берутся напрямую из ответа `/api/v1/login`.

---

## 3. Данные о дисциплинах пользователя

- **Статус:** **Решено.**
- **Источник данных:** Дисциплины пользователя **уже содержатся** в объекте `user`, который приходит с бэкенда.
- **Название поля:** Поле называется `sports`.
- **Структура:** Это массив объектов вида `{ id: string, name: string }`.
    ```json
    "sports": [
      { "id": "sport-1", "name": "Футбол" },
      { "id": "sport-2", "name": "Баскетбол" }
    ]
    ```
- **Действие:** **Не делать** отдельный запрос на `/api/sports` для получения дисциплин пользователя. Вместо этого, извлекать данные из поля `user.sports`.
